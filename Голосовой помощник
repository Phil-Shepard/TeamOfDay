import pyttsx3
import json
import speech_recognition as sr
import datetime
import webbrowser
import os

engine = pyttsx3.init()
ru_voice_id = "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Speech\\Voices\\Tokens\\TTS_MS_RU-RU_IRINA_11.0"
voices = engine.getProperty('voices')
engine.setProperty('voice', ru_voice_id)

def speak(audio):
    engine.say(audio)
    engine.runAndWait()

def wishMe():
    hour = int(datetime.datetime.now().hour)
    if hour>= 0 and hour<12:
        speak("Доброе утро!")
  
    elif hour>= 12 and hour<18:
        speak("Добрый день!")   
  
    else:
        speak("Доброго вечера!")  
  
    # Имя для голосового ассистента
    name = ("Имя")
    speak("Я ваш ассистент!")
    speak(name)
      
def takeCommand():
     
    r = sr.Recognizer()
     
    with sr.Microphone() as source:
         
        print("Слушаю...")
        r.pause_threshold = 1
        audio = r.listen(source)
  
    try:
        print("Распознаю...")    
        query = r.recognize_google(audio, language ='ru-RU')
        print(f"Пользователь сказал: {query}\n")
  
    except Exception as e:
        print(e)    
        print("Не удалось распознать вашу речь.")  
        return "None"
     
    return query

# Функции, которые написаны ниже были написаны для демонстрации работы записи и распознавания голоса пользователя.

if __name__ == '__main__':
    clear = lambda: os.system('cls')

    clear()
    wishMe()
     
    while True:
         
        query = takeCommand().lower()
 
        if 'открой youtube' in query:
            speak("Задача выполнена. Удачного просмотра!\n")
            webbrowser.open("youtube.com")
 
        elif 'открой гугл' in query or 'открой google' in query:
            speak("Задача выполнена. Счастливого сёрфинга!\n")
            webbrowser.open("google.com")
 
        elif 'открой stack overflow' in query:
            speak("Задача выполнена. Успехов в программировании!")
            webbrowser.open("stackoverflow.com")   
 
        elif 'включи музыку' in query:
            speak("Задача выполнена. Удачного прослушивания!")
            # music_dir = "G:\\Song"
            music_dir = ""
            songs = os.listdir(music_dir)
            print(songs)    
            random = os.startfile(os.path.join(music_dir))
 
        elif 'открой edge' in query:
            codePath = r"C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"
            os.startfile(codePath)
 
        elif 'как дела' in query:
            speak("У меня всё хорошо.")
            speak("А как дела у вас?")
 
        elif 'хорошо' in query or "отлично" in query:
            speak("Рада слышать, что у вас всё хорошо!")

        elif 'выход' in query:
            speak("Спасибо за уделённое время!")
            exit()
 
        elif "кто твой разработчик" in query or "кто создал тебя" in query: 
            speak("Я была создана Егором.")
 
        elif "напиши заметку" in query:
            speak("Что я должна написать")
            note = takeCommand()
            file = open('note.txt', 'w')
            file.write(note)
         
        elif "покажи заметку" in query:
            speak("Показываю заметки.")
            file = open("note.txt", "r") 
            print(file.read())
            speak(file.read(6))

        elif "я люблю тебя" in query:
            speak("Это тяжело понять...")

        else:
            speak("К сожалению, я не смог понять, что вы имели в виду...")
